<html lang="tr">
<head>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://d3js.org/topojson.v0.min.js"></script>
  <link rel="stylesheet" href="/static/css/leaflet.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <meta name=application-name content="GalBul">
  <script src="/static/js/leaflet.js"></script>
  <link rel="stylesheet" href="/static/css/index.css">
  <link rel="icon" href="{{ url_for('static',filename='logo.png') }}">
  <title>{{project_name}} ~ Ana Sayfa</title>
  <style>
      * {will-change: transform;}
  </style>
</head>
<body>
<div id="mapid"style="border-radius: 2.5px;height: 100%; width: 100%;"></div>
<script>
function koordinat(enlem, boylam) {
  return new L.LatLng(enlem, boylam)
}
function main() {

  let parselData;
  var setViewLatLng = new L.LatLng(38.329355001, 28.0694747494);
  var mymap = L.map('mapid').setView(setViewLatLng, 19)
  var latlng2 = new L.LatLng(38.329355001, 28.0694747494);
  
  let redIcon = new L.Icon({
      iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',
      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

    let greenIcon = new L.Icon({
      iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });

  var parsel = L.polygon(
    [
      [28.06978000000, 38.32976000000].reverse(),
      [28.06968000000, 38.33009000000000000].reverse(),
      [28.06962000000, 38.33021000000000000].reverse(),
      [28.06957000000, 38.33028000000000000].reverse(),
      [28.06952000000, 38.33029000000000000].reverse(),
      [28.06945000000, 38.33027000000000000].reverse(),
      [28.06935000000, 38.33019000000000000].reverse(),
      [28.06928000000, 38.3301000000000000].reverse(),
      [28.06919000000, 38.32992000000000000].reverse(),
      [28.06913000000, 38.32979000000000000].reverse(),
      [28.06909000000, 38.32968000000000000].reverse(),
      [28.06909000000, 38.32962000000000000].reverse(),
      [28.06911000000, 38.32962000000000000].reverse(),
      [28.06911000000, 38.32956000000000000].reverse(),
      [28.06915000000, 38.3293000000000000].reverse(),
      [28.06926000000, 38.32929000000000000].reverse(),
      [28.06952000000, 38.32923000000000000].reverse(),
      [28.06972000000, 38.3292000000000000].reverse(),
      [28.06975000000, 38.32929000000000000].reverse(),
      [28.06978000000, 38.32939000000000000].reverse(),
      [28.06983000000, 38.32956000000000000].reverse(),
      [28.06978000000, 38.32966000000000000].reverse(),
      [28.06978000000, 38.3297600000000000].reverse()], {
    color: 'red'

  }).addTo(mymap);

  let parsel2 = L.polygon(
    [
      [27.66836, 37.86303].reverse(),
      [27.6685, 37.86303].reverse(),
      [27.66874, 37.86302].reverse(),
      [27.66901, 37.86302].reverse(),
      [27.66934, 37.86301].reverse(),
      [27.66948, 37.86313].reverse(),
      [27.66954, 37.86318].reverse(),
      [27.66955, 37.8632].reverse(),
      [27.66962, 37.86325].reverse(),
      [27.66966, 37.86332].reverse(),
      [27.66968, 37.86351].reverse(),
      [27.66971, 37.86368].reverse(),
      [27.66975, 37.86373].reverse(),
      [27.66978, 37.86375].reverse(),
      [27.67006, 37.86386].reverse(),
      [27.67012, 37.86389].reverse(),
      [27.67019, 37.86401].reverse(),
      [27.67023, 37.86413].reverse(),
      [27.6703, 37.86424].reverse(),
      [27.6712, 37.86429].reverse(),
      [27.67012, 37.86453].reverse(),
      [27.66654, 37.86537].reverse(),
      [27.66387, 37.86597].reverse(),
      [27.66375, 37.866].reverse(),
      [27.66351, 37.86605].reverse(),
      [27.6635, 37.86599].reverse(),
      [27.66348, 37.86587].reverse(),
      [27.66345, 37.86569].reverse(),
      [27.66324, 37.86446].reverse(),
      [27.6632, 37.86423].reverse(),
      [27.66449, 37.86413].reverse(),
      [27.66448, 37.86389].reverse(),
      [27.66448, 37.8636].reverse(),
      [27.66448, 37.86298].reverse(),
      [27.66468, 37.86299].reverse(),
      [27.66494, 37.863].reverse(),
      [27.66558, 37.86302].reverse(),
      [27.6661, 37.86304].reverse(),
      [27.66651, 37.86306].reverse(),
      [27.66683, 37.86307].reverse(),
      [27.66714, 37.86308].reverse(),
      [27.66723, 37.86312].reverse(),
      [27.66766, 37.8631].reverse(),
      [27.668, 37.8631].reverse(),
      [27.66811, 37.86304].reverse(),
      [27.66836, 37.86303].reverse(),
    ], {color: 'green'})

  let googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
    maxZoom: 20,
    subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
  });
  googleSat.addTo(mymap)

  navigator.geolocation.getCurrentPosition(function (location, options = {
    enableHighAccuracy: true,
    timeout: 5000,
    maximumAge: 0
  }) {
    mymap.setView(new L.LatLng(37.865675150603856, 27.664381410442175))

    L.marker(latlng2, { icon: redIcon }).bindPopup("Riskli Gal Arısı, Nazilli/Aydın E: 37.8618 B: 27.2534").addTo(mymap);
    L.marker(koordinat(38.3526662, 27.6821678), { icon: redIcon }).bindPopup("Riskli Gal Arısı, Nazilli/Aydın E: 37.8618 B: 27.2534").addTo(mymap);
    L.marker(koordinat(38.3473424, 27.6853388), { icon: redIcon }).bindPopup("Riskli Gal Arısı, Nazilli/Aydın E: 37.8618 B: 27.2534").addTo(mymap);
    L.marker(koordinat(38.3500182, 27.6866751), { icon: redIcon }).bindPopup("Riskli Gal Arısı, Nazilli/Aydın E: 37.8618 B: 27.2534").addTo(mymap);
    L.marker(koordinat(38.3509533, 27.6856382), { icon: redIcon }).bindPopup("Riskli Gal Arısı, Nazilli/Aydın E: 37.8618 B: 27.2534").addTo(mymap);
    
  });
} main()

const getParsel = async function (location) {
  let result = await fetch(`/parselSorgu/${location.coords.latitude}/${location.coords.longitude}`, {
    method: "GET",
    headers: {
      "Content-Type": "application/json",
			'Access-Control-Allow-Methods': 'OPTIONS,POST',
			'Access-Control-Allow-Credentials': true,
			'Access-Control-Allow-Origin': '*',
			'X-Requested-With': '*',
    }
  })
  
  return result.json();
}
</script>
</body>
</html>